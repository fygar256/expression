# pythonで書いた式の評価モジュール

16進整数、10進整数、floatを数として使える。

演算子と優先順位はpythonを基にして次の通り

(expression)            括弧で囲った式

-,~                     負、ビットNOT

*,/                     乗算、整数除算

+,-                     加算、減算

<<,>>                   左シフト、右シフト

&                       ビットAND

|                       ビットOR

'                       符号拡張

<=,<,>,>=,!=,==         比較演算子

!x                      論理NOT

&&                      論理AND

||                      論理OR

'演算子について

a'24とすると、aの24ビット目を符号として符号拡張をします。

使い方

import expressionとして、インポートし、

(value,index)=expression.expression(string,0)のように呼び出してください。

stringに式を与え、0は文字列のどこから評価を始めるかのインデックスです。

stringの後ろには番人としてchr(0)を付けておいてください。

valueに式の値が、indexに次のインデックスが返ります。

# Cによる再帰下降型の式の評価の一般的なサンプルプログラム

コンパイラやインタプリタを書くときに役に立つと思います。Cではわざわざプログラムを書かなければ式の評価は出来ません。

doubleで演算しています。

16進数、10進整数、doubleを数として扱えます。

呼び出し先の関数では、

expression(char ss) {

s=ss;

処理

ss=s;

return val;

}

とする。

char line[256]="",*s=line;

x=expression(&s)として呼び出すようにする。

処理が終わったら、値xと、次のポインタをsに返します。

演算子と優先順位はpythonを基にして次の通り

(expression)            括弧で囲った式

-,~                     負、ビットNOT

*,/                     乗算、整数除算

+,-                     加算、減算

<<,>>                   左シフト、右シフト

&                       ビットAND

|                       ビットOR

^                       ビットXOR

'                       符号拡張

<=,<,>,>=,!=,==         比較演算子

!x                      論理NOT

&&                      論理AND

||                      論理OR

'演算子について

a'24で、aの24ビット目を符号として符号拡張します。

ライブラリにする時のヘッダ

extern double expression(char **s);

